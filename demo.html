<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./node_modules/layui.css">
    <link rel="stylesheet" href="./css/demo.css">

</head>

<body>
    <!-- 设备列表弹窗 -->
    <div class="detail">
        <div class="biu">
            <div class="biu-title">
                基本信息
            </div>
            <img class="flag" style="width: 200px; height: 200px;"
                src=""
                alt="logo" srcset="">
            <div class="right-info">

            </div>
        </div>
        <div class="data-record">
            <div class="data-record-title">
                数据记录
                <div class="layui-btn-container">
                    <button id="day" type="button" class="layui-btn layui-btn-primary">最近三天</button>
                    <button id="week" type="button" class="layui-btn layui-btn-primary">最近一周</button>
                    <button id="month" type="button" class="layui-btn layui-btn-primary">最近一月</button>
                </div>
            </div>
            <div class="data-record-content">

            </div>
        </div>
        <div class="classify">
            <button id='realtime' id="day" type="button" class="layui-btn">实时图表</button>
            <button id="history" type="button" class="layui-btn layui-btn-primary">历史数据</button>
            <button id="alarm" type="button" class="layui-btn layui-btn-primary">历史报警</button>
        </div>
        <div class="chartShow">
		 <div id="chartShow-aftercurrent">

            </div>
            <div id="chartShow-temperature">

            </div>
            <div id="chartShow-electric">

            </div>
            <div id="chartShow-voltage">

            </div>
           
            <div id="chartShow-liquidLevel">

            </div>
            <div id="chartShow-pressure">

            </div>
            <div id="chartShow-smokeDetector">

            </div>
            <div id="chartShow-combustible">

            </div>
            <div id="chartShow-signal">

            </div>
            <div id="chartShow-kwh">

            </div>
        </div>

        <div class="historyData" style="display: none;">
            <table class="layui-hide" id="historyData"></table>
        </div>

        <div class="alarmInfo" style="display: none;">
            <table class="layui-hide" id="alarmInfo"></table>
        </div>
    </div>
</body>
<script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.1.0/echarts.min.js"></script>
<script src="./node_modules/layui.js"></script>
<script src="./js/deviceList.js"></script>
<script type="module">
    import {
        baseUrl
    } from './js/params.js'
    layui.use(['element', 'layer', 'table', 'form'], function () {

        var $ = layui.jquery

        var electricSign = []; //电流标志
        var voltageSign = []; //电压标志
        var temperatureSign = []; //温度标志
        var electricRASign = []; //剩余电流标志
        var electricA = []; //A相电流
        var electricB = []; //B相电流
        var electricC = []; //C相电流
        var voltageA = []; //A相电压
        var voltageB = []; //B相电压
        var voltageC = []; //C相电压
        var temperatureA = []; //A相温度
        var temperatureB = []; //B相温度
        var temperatureC = []; //C相温度
        var temperatureE = []; //环境温度
        var electricRA = []; //剩余电流
        var time = []; //时间
        var liquidLevel = [] //液位
        var liquidLevelSign = [] //液位标志
        var pressure = [] //压力
        var pressureSign = [] //压力标志
        var smokeDetector = []  //烟感
        var smokeDetectorSign = []  //烟感标志
        var combustible = [] //可燃气体
        var combustibleSign = [] //可燃气体标志
        var signal = [] //信号强度
        var signalSign = [] //信号强度标志
        var kwh = []  //电池电量
        var kwhSign = [] //电池电量标志
        function getUrl(url) {
            // 先获取href问号以及问号后的内容
            if (url) {
                url = url.substr(url.indexOf("?"))
            } else {
                url = window.location.search
            }
            //判断是否含有问号，有则说明含有参数
            if (url.indexOf("?") !== -1) {
                var str = url.substr(1)
                var strs = str.split("&")
                var obj = new Object()
                for (var i = 0; i < strs.length; i++) {
                    obj[strs[i].split("=")[0]] = strs[i].split("=")[1];
                }
                return obj
            }
            return null
        }

        var deviceId = null

        //历史数据表格回调
        $.ajax({
            url: baseUrl + "/deviceworkdata/list?token=" + JSON.parse(localStorage.getItem('loginInfo'))
                .token,
            type: 'get',
            async: false,
            data: getUrl(window.location.href),
            success: function (res) {
                if(res.code === 200){
                var tableTitle = []
                const { fieldlist, dataList } = res.rows
                //历史信息表格
                var tableTitle = fieldlist.map(item => {
                    return { field: item.dataType, title: item.typeDes,align:'center' }
                })
                tableTitle.unshift({ field: 'happen_time', title: '上报时间',width:110,align:'center'  })
                //渲染历史数据表格
                layui.use('table', function () {
                    var table = layui.table;

                    table.render({
                        elem: '#historyData',
                        id: "tableReload",
                        url: baseUrl + "/deviceworkdata/list?token=" + JSON.parse(localStorage.getItem('loginInfo'))
                            .token
                        , request: {
                            pageName: 'pageNumber' //页码的参数名称，默认：page
                            , limitName: 'pageSize' //每页数据量的参数名，默认：limit
                        },
                        where: {
                            id: getUrl(window.location.href).id
                        },
                        parseData: function (response) {
                            return {
                                "data": response.rows.dataList.rows,
                                "code": 0,
                                "count": response.rows.dataList.total,
                                'status': res.code,
                                'msg': res.msg
                            }
                        }
                        , page: true
						, skin: 'line'
						, even: true
                        , cellMinWidth: 60 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
                        , cols: [tableTitle]
                        , done: function(res){
                            if(res.status === 20001){
                                layer.alert('登录已过期请重新登陆', {
                                    skin: 'layui-layer-yingke' //样式类名
                                    ,closeBtn: 0
                                    }, function(){
                                        parent.location.href = './index.html'
                                    });
                            } else if(res.status === 200) {
                                
                            } else {
                                layer.msg(res.msg, {
                                    icon: 2,
                                    closeBtn: 0,
                                    anim: 6, //动画类型
                                    time: 3000
                                });
                            }
                        }
                    });
                });
                }else if(res.code === 20001){
                        layer.alert('登录已过期请重新登陆', {
                            skin: 'layui-layer-yingke' //样式类名
                            ,closeBtn: 0
                            }, function(){
                                parent.location.href = './index.html'
                            });
                    } else {
                        layer.msg(res.msg, {
                            icon: 2,
                            closeBtn: 0,
                            anim: 6, //动画类型
                            time: 3000
                        });
                    }
            }
        })

        //报警信息
        layui.use('table', function () {
            var table = layui.table;
            table.render({
                elem: '#alarmInfo',
                id: "alarmTableReload",
                url: baseUrl + '/alarm/listtodevice?token=' + JSON.parse(localStorage.getItem('loginInfo'))
                    .token
                , request: {
                    pageName: 'pageNumber' //页码的参数名称，默认：page
                    , limitName: 'pageSize' //每页数据量的参数名，默认：limit
                },
                where: {
                    ykDeviceId: getUrl(window.location.href).id
                },
                parseData: function (response) {
                    return {
                        "data": function(){
                            response.rows.rows.map(item=>{
                                item.alarmData = item.alarmData + '' + item.data_unit
                            })
                            return response.rows.rows
                        }(),
                        "code": 0,
                        "count": response.rows.total,
                        'status': response.code,
                        'msg': response.msg
                    }
                }
                , page: true
                , skin: 'line'
                , even: true
                , cellMinWidth: 60 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
                , cols: [
                    [ //表头
                        {
                            field: 'alarmTime',
                            align: "center",
                            title: '报警时间',
                            sort: true
                        },
                        {
                            field: 'alarmMessage',
                            title: '报警类型',
                            align: "center"
                        },
                        {
                            field: 'alarmData',
                            align: "center",
                            title: '报警值',
                            width: 100,
                            sort: true
                        },
                        {
                            field: 'location',
                            title: '地点',
                            align: "center"
                        }
                    ]
                ]
                , done: function(res){
                    if(res.status === 20001){
                        layer.alert('登录已过期请重新登陆', {
                            skin: 'layui-layer-yingke' //样式类名
                            ,closeBtn: 0
                            }, function(){
                                parent.location.href = './index.html'
                            });
                    } else if(res.status === 200) {
                        
                    } else {
                        layer.msg(res.msg, {
                            icon: 2,
                            closeBtn: 0,
                            anim: 6, //动画类型
                            time: 3000
                        });
                    }
                }
            });
        });
        //处理回调
        $.ajax({
            url: baseUrl + "/deviceworkdata/zxlist?token=" + JSON.parse(localStorage.getItem('loginInfo'))
                .token,
            type: 'get',
            async: false,
            data: getUrl(window.location.href),
            success: function (response) {
                if(response.code === 200){
                const {
                    data, deviceInfo, deviceData
                } = response.rows
                deviceId = deviceInfo.deviceId
                if(deviceInfo.deviceSmallType === '01'){
                    $('.flag').attr('src', './img/dian.png')
                }else if(deviceInfo.deviceSmallType === '02' || deviceInfo.deviceSmallType === '03'){
                    $('.flag').attr('src', './img/shui.png')
                }else if(deviceInfo.deviceSmallType === '06'){
                    $('.flag').attr('src', './img/yan.png') 
                }else if(deviceInfo.deviceSmallType === '07'){
                    $('.flag').attr('src', './img/krq.jpg') 
                }
                //添加设备基本信息
                $('.right-info').append(
                    `
                    <p style="padding-left:20px">${deviceInfo.imei}</p>
                        <div class="right-content">
						<p>所属单位：${deviceInfo.companyName}</p>
                        <p>设备名称：${deviceInfo.location}</p>
                        <p>设备类型：${function(){
                            switch (deviceInfo.deviceSmallType) {
                                case '01':
                                    return '智慧电气监测'
                                    break;
                                case '02':
                                    return '智慧水压监测'
                                    break;
                                case '03':
                                    return '智慧水位监测'
                                    break;
                                case '05':
                                    return '可视化联网报警'
                                    break;
                                case '06':
                                    return '智慧型独立烟感'
                                    break;
                                case '07':
                                    return '可燃气体检测'
                                    break;
                            
                                default:
                                    break;
                            }
                        }()}</p>
                        <p>设备状态：${(function () {
                        if (deviceInfo.state === 1) {
                            return '在线'
                        } else if (deviceInfo.state === 2) {
                            return '离线'
                        } else if (deviceInfo.state === 3) {
                            return '报警'
                        } else if (deviceInfo.state === 4) {
                            return '故障'
                        }
                    })()}</p>
                    </div>
                    `
                )

               
                // 水位 03
                if (response.rows.deviceType === '03') {
                    if (response.code === 200) {
                        time = response.rows.time
                        liquidLevelSign.push(data[0].typeDes)
                        signalSign.push('信号强度')
                        kwhSign.push('电池电量')
                        data.map(item => {
                            switch (item.dataType) {
                                case "F":
                                    liquidLevel = item.value
                                    break;
                                case "Q":
                                    signal = item.value
                                    break;
                                case "V":
                                    kwh = item.value
                                    break;
                                default:
                                    break;
                            }
                        })
                    }
                    //echars
                    var myChartL = echarts.init(document.getElementById('chartShow-liquidLevel'),
                        null, {
                        renderer: 'svg'
                    });
                    var myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                        null, {
                        renderer: 'svg'
                    });
                    var myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                        null, {
                        renderer: 'svg'
                    });

                    //液位
                    var optionL = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: liquidLevelSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '液位',
                            type: 'line',
                            data: liquidLevel,
							markPoint: {
							data: [
								{type: 'max', name: '最高水位'},
								]
							}
                        }]
                    };
                    //电池电量
                    var optionV = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: kwhSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '电池电量',
                            type: 'line',
                            data: kwh
                        }]
                    };
                    //  信号强度
                    var optionQ = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: signalSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '信号强度',
                            type: 'line',
                            data: signal,
							markPoint: {
							data: [
								{type: 'max', name: '信号阈值'},
								]
							}
                        }]
                    };
                    optionL && myChartL.setOption(optionL);
                    optionQ && myChartQ.setOption(optionQ);
                    optionV && myChartV.setOption(optionV);


                    const infoMapData = data.map(item => {
                        var value = item.value.pop()
                        return `
                        <p>
                            <span class="data-record-content-icon"></span>
                            <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                        </p>
                    `
                    })

                    var time = time.pop()
                    const $infoData = `
                    <div class="data-record-content-time">
                        最后上报时间 : ${time === undefined ? '-' : time}
                    </div>
                    ${infoMapData.join('')}
                    `
                    $(".data-record-content").html($infoData)

                    // 判断节点是否显示
                    if ($('#chartShow-temperature').children().length === 0) {
                        $('#chartShow-temperature').css('display', 'none')
                    }
                    if ($('#chartShow-electric').children().length === 0) {
                        $('#chartShow-electric').css('display', 'none')
                    }
                    if ($('#chartShow-voltage').children().length === 0) {
                        $('#chartShow-voltage').css('display', 'none')
                    }
                    if ($('#chartShow-aftercurrent').children().length === 0) {
                        $('#chartShow-aftercurrent').css('display', 'none')
                    }
                    if ($('#chartShow-liquidLevel').children().length === 0) {
                        $('#chartShow-liquidLevel').css('display', 'none')
                    }
                    if ($('#chartShow-pressure').children().length === 0) {
                        $('#chartShow-pressure').css('display', 'none')
                    }
                    if ($('#chartShow-smokeDetector').children().length === 0) {
                        $('#chartShow-smokeDetector').css('display', 'none')
                    }
                    if ($('#chartShow-combustible').children().length === 0) {
                        $('#chartShow-combustible').css('display', 'none')
                    }
                    if ($('#chartShow-signal').children().length === 0) {
                        $('#chartShow-signal').css('display', 'none')
                    }
                    if ($('#chartShow-kwh').children().length === 0) {
                        $('#chartShow-kwh').css('display', 'none')
                    }
                } else if (response.rows.deviceType === '01') {
                    //电
                    if (response.code === 200) {
                        time = response.rows.time
                        voltageSign.push(data[1].typeDes, data[2].typeDes, data[3].typeDes)
                        electricSign.push(data[4].typeDes, data[5].typeDes, data[6].typeDes)
                        temperatureSign.push(data[7].typeDes, data[8].typeDes, data[9].typeDes, data[10]
                            .typeDes)
                        electricRASign.push(data[0].typeDes)
                        data.map(item => {
                            switch (item.dataType) {
                                case "residue_electricity":
                                    electricRA = item.value
                                    break;
                                case "a_voltage":
                                    voltageA = item.value
                                    break;
                                case "b_voltage":
                                    voltageB = item.value
                                    break;
                                case "c_voltage":
                                    voltageC = item.value
                                    break;
                                case "a_electricity":
                                    electricA = item.value
                                    break;
                                case "b_electricity":
                                    electricB = item.value
                                    break;
                                case "c_electricity":
                                    electricC = item.value
                                    break;
                                case "a_temperature":
                                    temperatureA = item.value
                                    break;
                                case "b_temperature":
                                    temperatureB = item.value
                                    break;
                                case "c_temperature":
                                    temperatureC = item.value
                                    break;
                                case "environment_temperature":
                                    temperatureE = item.value
                                    break;
                                default:
                                    break;
                            }
                        })
                    }
                    //echars
                    var myChartA = echarts.init(document.getElementById('chartShow-temperature'),
                        null, {
                        renderer: 'svg'
                    });
                    var myChartV = echarts.init(document.getElementById('chartShow-electric'), null, {
                        renderer: 'svg'
                    });
                    var myChartT = echarts.init(document.getElementById('chartShow-voltage'), null, {
                        renderer: 'svg'
                    });
                    var myChartRA = echarts.init(document.getElementById('chartShow-aftercurrent'),
                        null, {
                        renderer: 'svg'
                    });
                    //电流
                    var optionA = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: electricSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
                            //max: function (value) { return value.max },
							//max: function (value) { return '100' },
							max: function (value) { return value.max >= 100 ? value.max : 100 },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: 'A相电流',
                            type: 'line',
                            data: electricA,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"red",
						  },
							data: [
							{yAxis:'100',label: {position:'middle',formatter: '电流阈值:100A'}}
							]
							}
                        },
                        {
                            name: 'B相电流',
                            type: 'line',
                            data: electricB,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							}
                        },
                        {
                            name: 'C相电流',
                            type: 'line',
                            data: electricC,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							}
                        }
                        ]
                    };
                    //电压
                    var optionV = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: voltageSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
                            //max: function (value) { return value.max },
							//max: function (value) { return '300' },
							max: function (value) { return value.max >= 264 ? value.max : 264 },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: 'A相电压',
                            type: 'line',
                            data: voltageA,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							},
							
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"green",
						  },
							data: [
							{yAxis:'187',label: {position:'middle',formatter: '低压阈值:187V'}}
							]
							}
                        },
                        {
                            name: 'B相电压',
                            type: 'line',
                            data: voltageB,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"red",
						  },
							data: [
							{yAxis:'264',label: {position:'middle',formatter: '高压阈值:264V'}}
							]
							}
                        },
                        {
                            name: 'C相电压',
                            type: 'line',
                            data: voltageC,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							},
                        }
                        ]
                    };
                    //温度
                    var optionT = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: temperatureSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
                            //max: function (value) { return value.max },
							//max: function (value) { return '75' },
							max: function (value) { return value.max >= 70 ? value.max : 70 },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
						
                        series: [{
                            name: 'A相温度',
                            type: 'line',
                            data: temperatureA,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"red",
						  },
							data: [
							{yAxis:'70',label: {position:'middle',formatter: '温度阈值:70℃'}}
							]
							}
                        },
                        {
                            name: 'B相温度',
                            type: 'line',
                            data: temperatureB,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							}
                        },
                        {
                            name: 'C相温度',
                            type: 'line',
                            data: temperatureC,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							}
                        },
                        {
                            name: '环境温度',
                            type: 'line',
                            data: temperatureE,
							
                        },
						
						
                        ]
                    };
                    //剩余电流
                    var optionRA = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: electricRASign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
                            max: function (value) 
							{ return value.max >= 300 ? value.max : 300 },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '剩余电流',
                            type: 'line',
                            data: electricRA,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							  //警示线的样式，虚实  颜色
							  lineStyle:{
								type:"dashed",
								color:"red",
							  },
							data: [
								{yAxis:'300',label: {position:'middle',formatter: '漏电阈值:300Ma'}}
								]
							}
                        }]
                    };
                    optionA && myChartA.setOption(optionA);
                    optionV && myChartV.setOption(optionV);
                    optionT && myChartT.setOption(optionT);
                    optionRA && myChartRA.setOption(optionRA);
                    const infoMapData = data.map(item => {
                        var value = item.value.pop()
                        return `
                        <p>
                            <span class="data-record-content-icon"></span>
                            <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                        </p>
                    `
                    })

                    var time = time.pop()
                    const $infoData = `
                    <div class="data-record-content-time">
                        最后上报时间 : ${time === undefined ? '-' : time}
                    </div>
                    ${infoMapData.join('')}
                    `
                    $(".data-record-content").html($infoData)

                    // 判断节点是否显示
                    if ($('#chartShow-liquidLevel').children().length === 0) {
                        $('#chartShow-liquidLevel').css('display', 'none')
                    }
                    if ($('#chartShow-pressure').children().length === 0) {
                        $('#chartShow-pressure').css('display', 'none')
                    }
                    if ($('#chartShow-smokeDetector').children().length === 0) {
                        $('#chartShow-smokeDetector').css('display', 'none')
                    }
                    if ($('#chartShow-combustible').children().length === 0) {
                        $('#chartShow-combustible').css('display', 'none')
                    }
                    if ($('#chartShow-signal').children().length === 0) {
                        $('#chartShow-signal').css('display', 'none')
                    }
                    if ($('#chartShow-kwh').children().length === 0) {
                        $('#chartShow-kwh').css('display', 'none')
                    }
                } else if (response.rows.deviceType === '02') {
                    //水压 02
                    if (response.code === 200) {
                        time = response.rows.time
                        pressureSign.push(data[0].typeDes)
                        signalSign.push('信号强度')
                        kwhSign.push('电池电量')
                        data.map(item => {
                            switch (item.dataType) {
                                case "F":
                                    pressure = item.value
                                    break;
                                case "Q":
                                    signal = item.value
                                    break;
                                case "V":
                                    kwh = item.value
                                    break;
                                default:
                                    break;
                            }
                        })
                    }

                    
                    //echars
                    var myChartP = echarts.init(document.getElementById('chartShow-pressure'),
                        null, {
                        renderer: 'svg'
                    });

                    let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                        null, {
                        renderer: 'svg'
                    });

                    let myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                        null, {
                        renderer: 'svg'
                    });

                    //水压
                    var optionP = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: pressureSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							//max: function (value) { return value.max },
							max: function (value) { return value.max >= 1 ? value.max : 1 },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '压力',
                            type: 'line',
                            data: pressure,
							markPoint: {
							data: [
								{type: 'max', name: '最大值'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"red",
						  },
							data: [
							{yAxis:'1',label: {position:'middle',formatter: '阈值:1Mpa'}}
							]
							}
                        }]
                    };

                    //电池电量
                    var optionV = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: kwhSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '电池电量',
                            type: 'line',
                            data: kwh
                        }]
                    };

                    //信号强度
                    let optionQ = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: signalSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '信号强度',
                            type: 'line',
                            data: signal,
							markPoint: {
							data: [
								{type: 'max', name: '信号阈值'},
								]
							}
                        }]
                    };
                    optionP && myChartP.setOption(optionP);
                    optionQ && myChartQ.setOption(optionQ);
                    optionV && myChartV.setOption(optionV);

                    const infoMapData = data.map(item => {
                        var value = item.value.pop()
                        return `
                        <p>
                            <span class="data-record-content-icon"></span>
                            <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                        </p>
                    `
                    })

                    var time = time.pop()
                    const $infoData = `
                    <div class="data-record-content-time">
                        最后上报时间 : ${time === undefined ? '-' : time}
                    </div>
                    ${infoMapData.join('')}
                    `
                    $(".data-record-content").html($infoData)

                    // 判断节点是否显示
                    if ($('#chartShow-temperature').children().length === 0) {
                        $('#chartShow-temperature').css('display', 'none')
                    }
                    if ($('#chartShow-electric').children().length === 0) {
                        $('#chartShow-electric').css('display', 'none')
                    }
                    if ($('#chartShow-voltage').children().length === 0) {
                        $('#chartShow-voltage').css('display', 'none')
                    }
                    if ($('#chartShow-aftercurrent').children().length === 0) {
                        $('#chartShow-aftercurrent').css('display', 'none')
                    }
                    if ($('#chartShow-liquidLevel').children().length === 0) {
                        $('#chartShow-liquidLevel').css('display', 'none')
                    }
                    if ($('#chartShow-pressure').children().length === 0) {
                        $('#chartShow-pressure').css('display', 'none')
                    }
                    if ($('#chartShow-smokeDetector').children().length === 0) {
                        $('#chartShow-smokeDetector').css('display', 'none')
                    }
                    if ($('#chartShow-combustible').children().length === 0) {
                        $('#chartShow-combustible').css('display', 'none')
                    }
                    if ($('#chartShow-signal').children().length === 0) {
                        $('#chartShow-signal').css('display', 'none')
                    }
                    if ($('#chartShow-kwh').children().length === 0) {
                        $('#chartShow-kwh').css('display', 'none')
                    }
                } else if (response.rows.deviceType === '06') {
                    //烟感 06
                    if (response.code === 200) {
                        time = response.rows.time
                        smokeDetectorSign.push('电压')
                        signalSign.push('信号强度')
                        data.map(item => {
                            switch (item.dataType) {
                                case "V":
                                    smokeDetector = item.value
                                    break;
                                case "Q":
                                    signal = item.value
                                    break;
                                default:
                                    break;
                            }
                        })
                    }

                    //echars
                    var myChartS = echarts.init(document.getElementById('chartShow-smokeDetector'),
                        null, {
                        renderer: 'svg'
                    });

                    let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                        null, {
                        renderer: 'svg'
                    });

                    //电池电压
                    var optionS = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: smokeDetectorSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							//max: function (value) { return value.max },
							max: function (value) { return '3.5' },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
							
                        },
                        series: [{
                            name: '电压',
                            type: 'line',
                            data: smokeDetector,
							markPoint: {
							data: [
								{type: 'min', name: '最低电压'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"red",
						  },
							data: [
							{yAxis:'2.8',label: {position:'middle',formatter: '电池低压阈值:2.8V'}}
							]
							}
                        }]
                    };

                    //信号强度
                    let optionQ = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: signalSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
                        },
                        series: [{
                            name: '信号强度',
                            type: 'line',
                            data: signal,
							markPoint: {
							data: [
								{type: 'max', name: '信号阈值'},
								]
							}
                        }]
                    };
                    optionS && myChartS.setOption(optionS);
                    optionQ && myChartQ.setOption(optionQ);

                    const infoMapData = data.map(item => {
                        var value = item.value.pop()
                        return `
                        <p>
                            <span class="data-record-content-icon"></span>
                            <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                        </p>
                    `
                    })

                    var time = time.pop()
                    const $infoData = `
                    <div class="data-record-content-time">
                        最后上报时间 : ${time === undefined ? '-' : time}
                    </div>
                    ${infoMapData.join('')}
                    `
                    $(".data-record-content").html($infoData)

                    // 判断节点是否显示
                    if ($('#chartShow-temperature').children().length === 0) {
                        $('#chartShow-temperature').css('display', 'none')
                    }
                    if ($('#chartShow-electric').children().length === 0) {
                        $('#chartShow-electric').css('display', 'none')
                    }
                    if ($('#chartShow-voltage').children().length === 0) {
                        $('#chartShow-voltage').css('display', 'none')
                    }
                    if ($('#chartShow-aftercurrent').children().length === 0) {
                        $('#chartShow-aftercurrent').css('display', 'none')
                    }
                    if ($('#chartShow-liquidLevel').children().length === 0) {
                        $('#chartShow-liquidLevel').css('display', 'none')
                    }
                    if ($('#chartShow-pressure').children().length === 0) {
                        $('#chartShow-pressure').css('display', 'none')
                    }
                    if ($('#chartShow-smokeDetector').children().length === 0) {
                        $('#chartShow-smokeDetector').css('display', 'none')
                    }
                    if ($('#chartShow-combustible').children().length === 0) {
                        $('#chartShow-combustible').css('display', 'none')
                    }
                    if ($('#chartShow-signal').children().length === 0) {
                        $('#chartShow-signal').css('display', 'none')
                    }
                    if ($('#chartShow-kwh').children().length === 0) {
                        $('#chartShow-kwh').css('display', 'none')
                    }
                } else if (response.rows.deviceType === '07') {
                    //可燃气体 07
                    if (response.code === 200) {
                        time = response.rows.time
                        combustibleSign.push(data[1].typeDes)
                        data.map(item => {
                            switch (item.dataType) {
                                case "V":
                                    combustible = item.value
                                    break;
                                default:
                                    break;
                            }
                        })
                    }

                    //echars
                    var myChartS = echarts.init(document.getElementById('chartShow-combustible'),
                        null, {
                        renderer: 'svg'
                    });

                    //电池电压
                    var optionS = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: combustibleSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							//max: function (value) { return value.max },
							max: function (value) { return '3.5' },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
							
                        },
                        series: [{
                            name: '电压',
                            type: 'line',
                            data: combustible,
							markPoint: {
							data: [
								{type: 'min', name: '最低电压'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"red",
						  },
							data: [
							{yAxis:'2.8',label: {position:'middle',formatter: '电池低压阈值:2.8V'}}
							]
							}
                        }]
                    };
                    optionS && myChartS.setOption(optionS);

                    const infoMapData = data.map(item => {
                        var value = item.value.pop()
                        return `
                        <p>
                            <span class="data-record-content-icon"></span>
                            <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                        </p>
                    `
                    })

                    var time = time.pop()
                    const $infoData = `
                    <div class="data-record-content-time">
                        最后上报时间 : ${time === undefined ? '-' : time}
                    </div>
                    ${infoMapData.join('')}
                    `
                    $(".data-record-content").html($infoData)

                    // 判断节点是否显示
                    if ($('#chartShow-temperature').children().length === 0) {
                        $('#chartShow-temperature').css('display', 'none')
                    }
                    if ($('#chartShow-electric').children().length === 0) {
                        $('#chartShow-electric').css('display', 'none')
                    }
                    if ($('#chartShow-voltage').children().length === 0) {
                        $('#chartShow-voltage').css('display', 'none')
                    }
                    if ($('#chartShow-aftercurrent').children().length === 0) {
                        $('#chartShow-aftercurrent').css('display', 'none')
                    }
                    if ($('#chartShow-liquidLevel').children().length === 0) {
                        $('#chartShow-liquidLevel').css('display', 'none')
                    }
                    if ($('#chartShow-pressure').children().length === 0) {
                        $('#chartShow-pressure').css('display', 'none')
                    }
                    if ($('#chartShow-smokeDetector').children().length === 0) {
                        $('#chartShow-smokeDetector').css('display', 'none')
                    }
                    if ($('#chartShow-combustible').children().length === 0) {
                        $('#chartShow-combustible').css('display', 'none')
                    }
                    if ($('#chartShow-signal').children().length === 0) {
                        $('#chartShow-signal').css('display', 'none')
                    }
                    if ($('#chartShow-kwh').children().length === 0) {
                        $('#chartShow-kwh').css('display', 'none')
                    }
                }
                }else if(res.code === 20001){
                        layer.alert('登录已过期请重新登陆', {
                            skin: 'layui-layer-yingke' //样式类名
                            ,closeBtn: 0
                            }, function(){
                                parent.location.href = './index.html'
                            });
                    } else {
                        layer.msg(res.msg, {
                            icon: 2,
                            closeBtn: 0,
                            anim: 6, //动画类型
                            time: 3000
                        });
                    }
            },
            error: function () {

            }
        })


        $('.layui-btn').click(function () {
            $(this).removeClass('layui-btn-primary').siblings().addClass('layui-btn-primary')
            var index = $(this).attr('id')
            var day1 = new Date();
            var day2 = new Date();
            var day3 = new Date();
            day1.setTime(day1.getTime() - 24 * 60 * 60 * 1000 * 2);
            day2.setTime(day1.getTime() - 24 * 60 * 60 * 1000 * 6);
            day3.setTime(day1.getTime() - 24 * 60 * 60 * 1000 * 29);
            function format(){

            }
            var s1 = day1.getFullYear() + "-" + (day1.getMonth() + 1) + "-" + day1.getDate();
            var s2 = day2.getFullYear() + "-" + (day2.getMonth() + 1) + "-" + day2.getDate();
            var s3 = day3.getFullYear() + "-" + (day3.getMonth() + 1) + "-" + day3.getDate();
          
            if (index === 'day') {
                //最近三天
                $.ajax({
                    url: baseUrl + "/deviceworkdata/list?&pageSize=10&pageNumber=1&token=" + JSON.parse(localStorage.getItem('loginInfo'))
                        .token + "&happen_time=" + s1,
                    type: 'get',
                    data: getUrl(window.location.href),
                    success: function (res) {
                        if(res.code === 200){
                            const { fieldlist, dataList } = res.rows
                        //历史信息表格
                        var tableTitle = fieldlist.map(item => {
                            return { field: item.dataType, title: item.typeDes }
                        })
                        tableTitle.unshift({ field: 'happen_time', title: '上报时间' })

                        
                        //渲染历史数据表格
                        layui.use('table', function () {
                            var table = layui.table;

                            table.reload('tableReload', {
                                page: {
                                    curr: 1 //重新从第 1 页开始
                                }
                            });
                        });
                        }else if(res.code === 20001){
                            layer.alert('登录已过期请重新登陆', {
                                skin: 'layui-layer-yingke' //样式类名
                                ,closeBtn: 0
                                }, function(){
                                    parent.location.href = './index.html'
                                });
                        } else {
                            layer.msg(res.msg, {
                                icon: 1,
                                closeBtn: 0,
                                anim: 6, //动画类型
                                time: 3000
                            });
                        }
                    }
                })
                layui.use('table', function () {
                    var table = layui.table;
                    table.reload('alarmTableReload', {
                        page: {
                            curr: 1 //重新从第 1 页开始
                        },
                        where:{
                            alarmDate: s1,
                            ykDeviceId: getUrl(window.location.href).id
                        }
                    });
                });
                $.ajax({
                    url: baseUrl + "/deviceworkdata/zxlist?token=" + JSON.parse(localStorage.getItem('loginInfo'))
                        .token + "&happen_time=" + s1,
                    type: 'get',
                    data: getUrl(window.location.href),
                    success: function (response) {
                        if(response.code === 200){
                            const {
                            data, deviceInfo, deviceData
                        } = response.rows

                        // 水位 03
                        if (response.rows.deviceType === '03') {
                            if (response.code === 200) {
                                time = response.rows.time
                                liquidLevelSign.push(data[1].typeDes)
                                signalSign.push('信号强度')
                                kwhSign.push('电池电量')
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "F":
                                            liquidLevel = item.value
                                            break;
                                        case "Q":
                                            signal = item.value
                                            break;
                                        case "V":
                                            kwh = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }
                            //echars
                            var myChartL = echarts.init(document.getElementById('chartShow-liquidLevel'),
                                null, {
                                renderer: 'svg'
                            });
                            let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                null, {
                                renderer: 'svg'
                            });
                            let myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                                null, {
                                renderer: 'svg'
                            });

                            //液位
                            var optionL = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: liquidLevelSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: '液位',
                                    type: 'line',
                                    data: liquidLevel
                                }]
                            };
                            //电池电量
                            var optionV = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: kwhSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '电池电量',
                                    type: 'line',
                                    data: kwh
                                }]
                            };
                            //信号强度
                            let optionQ = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: signalSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '信号强度',
                                    type: 'line',
                                    data: signal,
                                    markPoint: {
                                    data: [
                                        {type: 'max', name: '信号阈值'},
                                        ]
                                    }
                                }]
                            };
                            optionL && myChartL.setOption(optionL);
                            optionQ && myChartQ.setOption(optionQ);
                            optionV && myChartV.setOption(optionV);



                            // 判断节点是否显示
                            if ($('#chartShow-temperature').children().length === 0) {
                                $('#chartShow-temperature').css('display', 'none')
                            }
                            if ($('#chartShow-electric').children().length === 0) {
                                $('#chartShow-electric').css('display', 'none')
                            }
                            if ($('#chartShow-voltage').children().length === 0) {
                                $('#chartShow-voltage').css('display', 'none')
                            }
                            if ($('#chartShow-aftercurrent').children().length === 0) {
                                $('#chartShow-aftercurrent').css('display', 'none')
                            }
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        } else if (response.rows.deviceType === '01') {
                            if (response.code === 200) {
                                time = response.rows.time
                                voltageSign.push(data[1].typeDes, data[2].typeDes, data[3].typeDes)
                                electricSign.push(data[4].typeDes, data[5].typeDes, data[6].typeDes)
                                temperatureSign.push(data[7].typeDes, data[8].typeDes, data[9].typeDes, data[10]
                                    .typeDes)
                                electricRASign.push(data[0].typeDes)
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "residue_electricity":
                                            electricRA = item.value
                                            break;
                                        case "a_voltage":
                                            voltageA = item.value
                                            break;
                                        case "b_voltage":
                                            voltageB = item.value
                                            break;
                                        case "c_voltage":
                                            voltageC = item.value
                                            break;
                                        case "a_electricity":
                                            electricA = item.value
                                            break;
                                        case "b_electricity":
                                            electricB = item.value
                                            break;
                                        case "c_electricity":
                                            electricC = item.value
                                            break;
                                        case "a_temperature":
                                            temperatureA = item.value
                                            break;
                                        case "b_temperature":
                                            temperatureB = item.value
                                            break;
                                        case "c_temperature":
                                            temperatureC = item.value
                                            break;
                                        case "environment_temperature":
                                            temperatureE = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }
                            //echars
                            var myChartA = echarts.init(document.getElementById('chartShow-temperature'),
                                null, {
                                renderer: 'svg'
                            });
                            var myChartV = echarts.init(document.getElementById('chartShow-electric'), null, {
                                renderer: 'svg'
                            });
                            var myChartT = echarts.init(document.getElementById('chartShow-voltage'), null, {
                                renderer: 'svg'
                            });
                            var myChartRA = echarts.init(document.getElementById('chartShow-aftercurrent'),
                                null, {
                                renderer: 'svg'
                            });
                            //电流
                            var optionA = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: electricSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: 'A相电流',
                                    type: 'line',
                                    data: electricA
                                },
                                {
                                    name: 'B相电流',
                                    type: 'line',
                                    data: electricB
                                },
                                {
                                    name: 'C相电流',
                                    type: 'line',
                                    data: electricC
                                }
                                ]
                            };
                            //电压
                            var optionV = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: voltageSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: 'A相电压',
                                    type: 'line',
                                    data: voltageA
                                },
                                {
                                    name: 'B相电压',
                                    type: 'line',
                                    data: voltageB
                                },
                                {
                                    name: 'C相电压',
                                    type: 'line',
                                    data: voltageC
                                }
                                ]
                            };
                            //温度
                            var optionT = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: temperatureSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: 'A相温度',
                                    type: 'line',
                                    data: temperatureA
                                },
                                {
                                    name: 'B相温度',
                                    type: 'line',
                                    data: temperatureB
                                },
                                {
                                    name: 'C相温度',
                                    type: 'line',
                                    data: temperatureC
                                },
                                {
                                    name: '环境温度',
                                    type: 'line',
                                    data: temperatureE
                                }
                                ]
                            };
                            //剩余电流
                            var optionRA = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: electricRASign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    max: function (value) { return value.max }
                                },
                                series: [{
                                    name: '剩余电流',
                                    type: 'line',
                                    data: electricRA
                                }]
                            };
                            optionA && myChartA.setOption(optionA);
                            optionV && myChartV.setOption(optionV);
                            optionT && myChartT.setOption(optionT);
                            optionRA && myChartRA.setOption(optionRA);


                            // 判断节点是否显示
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        } else if (response.rows.deviceType === '02') {
                            //水压 02
                            if (response.code === 200) {
                                time = response.rows.time
                                pressureSign.push(data[0].typeDes)
                                signalSign.push('信号强度')
                                kwhSign.push('电池电量')
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "F":
                                            pressure = item.value
                                            break;
                                        case "Q":
                                            signal = item.value
                                            break;
                                        case "V":
                                            kwh = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }

                            
                            //echars
                            var myChartP = echarts.init(document.getElementById('chartShow-pressure'),
                                null, {
                                renderer: 'svg'
                            });

                            var myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                null, {
                                renderer: 'svg'
                            });

                            var myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                                null, {
                                renderer: 'svg'
                            });

                            //液位
                            var optionP = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: pressureSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: '压力',
                                    type: 'line',
                                    data: pressure
                                }]
                            };
                            //电池电量
                            var optionV = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: kwhSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '电池电量',
                                    type: 'line',
                                    data: kwh
                                }]
                            };
                            //信号强度
                            let optionQ = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: signalSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '信号强度',
                                    type: 'line',
                                    data: signal,
                                    markPoint: {
                                    data: [
                                        {type: 'max', name: '信号阈值'},
                                        ]
                                    }
                                }]
                            };
                            optionP && myChartP.setOption(optionP);
                            optionQ && myChartQ.setOption(optionQ);
                            optionV && myChartV.setOption(optionV);



                            // 判断节点是否显示
                            if ($('#chartShow-temperature').children().length === 0) {
                                $('#chartShow-temperature').css('display', 'none')
                            }
                            if ($('#chartShow-electric').children().length === 0) {
                                $('#chartShow-electric').css('display', 'none')
                            }
                            if ($('#chartShow-voltage').children().length === 0) {
                                $('#chartShow-voltage').css('display', 'none')
                            }
                            if ($('#chartShow-aftercurrent').children().length === 0) {
                                $('#chartShow-aftercurrent').css('display', 'none')
                            }
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        } else if (response.rows.deviceType === '06') {
                            //烟感 06
                            if (response.code === 200) {
                                time = response.rows.time
                                smokeDetectorSign.push('电压')
                                signalSign.push('信号强度')
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "V":
                                            smokeDetector = item.value
                                            break;
                                        case "Q":
                                            signal = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }

                            //echars
                            var myChartS = echarts.init(document.getElementById('chartShow-smokeDetector'),
                                null, {
                                renderer: 'svg'
                            });

                            let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                null, {
                                renderer: 'svg'
                            });

                            //电池电压
                            var optionS = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: smokeDetectorSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: '电压',
                                    type: 'line',
                                    data: smokeDetector
                                }]
                            };
                            //信号强度
                            let optionQ = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: signalSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '信号强度',
                                    type: 'line',
                                    data: signal,
                                    markPoint: {
                                    data: [
                                        {type: 'max', name: '信号阈值'},
                                        ]
                                    }
                                }]
                            };
                            optionS && myChartS.setOption(optionS);
                            optionQ && myChartQ.setOption(optionQ);


                            // 判断节点是否显示
                            if ($('#chartShow-temperature').children().length === 0) {
                                $('#chartShow-temperature').css('display', 'none')
                            }
                            if ($('#chartShow-electric').children().length === 0) {
                                $('#chartShow-electric').css('display', 'none')
                            }
                            if ($('#chartShow-voltage').children().length === 0) {
                                $('#chartShow-voltage').css('display', 'none')
                            }
                            if ($('#chartShow-aftercurrent').children().length === 0) {
                                $('#chartShow-aftercurrent').css('display', 'none')
                            }
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        }else if (response.rows.deviceType === '07') {
                    //可燃气体 07
                    if (response.code === 200) {
                        time = response.rows.time
                        combustibleSign.push(data[1].typeDes)
                        data.map(item => {
                            switch (item.dataType) {
                                case "V":
                                    combustible = item.value
                                    break;
                                default:
                                    break;
                            }
                        })
                    }

                    //echars
                    var myChartS = echarts.init(document.getElementById('chartShow-combustible'),
                        null, {
                        renderer: 'svg'
                    });

                    //电池电压
                    var optionS = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: combustibleSign
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                saveAsImage: {}
                            }
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: time
                        },
                        yAxis: {
                            type: 'value',
							//max: function (value) { return value.max },
							max: function (value) { return '3.5' },
							show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
							axisTick:{
								  show:true//不显示坐标轴刻度线
							},
							axisLine: {
								  show: true,//不显示坐标轴线
							},
							axisLabel: {
								  show: true,//不显示坐标轴上的文字
							}
							
                        },
                        series: [{
                            name: '电压',
                            type: 'line',
                            data: combustible,
							markPoint: {
							data: [
								{type: 'min', name: '最低电压'},
								]
							},
							markLine: {
							symbol:"none", //表示没有箭头的直线
							lineStyle:{
							type:"dashed",
							color:"red",
						  },
							data: [
							{yAxis:'2.8',label: {position:'middle',formatter: '电池低压阈值:2.8V'}}
							]
							}
                        }]
                    };
                    optionS && myChartS.setOption(optionS);

                    const infoMapData = data.map(item => {
                        var value = item.value.pop()
                        return `
                        <p>
                            <span class="data-record-content-icon"></span>
                            <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                        </p>
                    `
                    })

                    var time = time.pop()
                    const $infoData = `
                    <div class="data-record-content-time">
                        最后上报时间 : ${time === undefined ? '-' : time}
                    </div>
                    ${infoMapData.join('')}
                    `
                    $(".data-record-content").html($infoData)

                    // 判断节点是否显示
                    if ($('#chartShow-temperature').children().length === 0) {
                        $('#chartShow-temperature').css('display', 'none')
                    }
                    if ($('#chartShow-electric').children().length === 0) {
                        $('#chartShow-electric').css('display', 'none')
                    }
                    if ($('#chartShow-voltage').children().length === 0) {
                        $('#chartShow-voltage').css('display', 'none')
                    }
                    if ($('#chartShow-aftercurrent').children().length === 0) {
                        $('#chartShow-aftercurrent').css('display', 'none')
                    }
                    if ($('#chartShow-liquidLevel').children().length === 0) {
                        $('#chartShow-liquidLevel').css('display', 'none')
                    }
                    if ($('#chartShow-pressure').children().length === 0) {
                        $('#chartShow-pressure').css('display', 'none')
                    }
                    if ($('#chartShow-smokeDetector').children().length === 0) {
                        $('#chartShow-smokeDetector').css('display', 'none')
                    }
                    if ($('#chartShow-combustible').children().length === 0) {
                        $('#chartShow-combustible').css('display', 'none')
                    }
                    if ($('#chartShow-signal').children().length === 0) {
                        $('#chartShow-signal').css('display', 'none')
                    }
                    if ($('#chartShow-kwh').children().length === 0) {
                        $('#chartShow-kwh').css('display', 'none')
                    }
                }
                        }else if(response.code === 20001){
                            layer.alert('登录已过期请重新登陆', {
                                skin: 'layui-layer-yingke' //样式类名
                                ,closeBtn: 0
                                }, function(){
                                    parent.location.href = './index.html'
                                });
                        } else {
                            layer.msg(response.msg, {
                                icon: 2,
                                closeBtn: 0,
                                anim: 6, //动画类型
                                time: 3000
                            });
                        }
                    },
                    error: function () {

                    }
                })
            } else if (index === 'week') {
                //最近一周
                $.ajax({
                    url: baseUrl + "/deviceworkdata/list?&pageSize=10&pageNumber=1&token=" + JSON.parse(localStorage.getItem('loginInfo'))
                        .token + "&happen_time=" + s2,
                    type: 'get',
                    data: getUrl(window.location.href),
                    success: function (res) {
                        if(res.code === 200){
                                const { fieldlist, dataList } = res.rows
                            //历史信息表格
                            var tableTitle = fieldlist.map(item => {
                                return { field: item.dataType, title: item.typeDes }
                            })
                            tableTitle.unshift({ field: 'happen_time', title: '上报时间' })

                            
                            //渲染历史数据表格
                            layui.use('table', function () {
                                var table = layui.table;

                                table.reload('tableReload', {
                                    page: {
                                        curr: 1 //重新从第 1 页开始
                                    }
                                });
                            });
                        }else if(res.code === 20001){
                            layer.alert('登录已过期请重新登陆', {
                                skin: 'layui-layer-yingke' //样式类名
                                ,closeBtn: 0
                                }, function(){
                                    parent.location.href = './index.html'
                                });
                        } else {
                            layer.msg(res.msg, {
                                icon: 1,
                                closeBtn: 0,
                                anim: 6, //动画类型
                                time: 3000
                            });
                        }
                    }
                })
                layui.use('table', function () {
                    var table = layui.table;
                    table.reload('alarmTableReload', {
                        page: {
                            curr: 1 //重新从第 1 页开始
                        },
                        where:{
                            alarmDate: s2,
                            ykDeviceId: getUrl(window.location.href).id
                        }
                    });
                });
                $.ajax({
                    url: baseUrl + "/deviceworkdata/zxlist?token=" + JSON.parse(localStorage.getItem('loginInfo'))
                        .token + "&happen_time=" + s2,
                    type: 'get',
                    data: getUrl(window.location.href),
                    success: function (response) {
                        if(response.code === 200){
                            
                        const {
                            data, deviceInfo, deviceData
                        } = response.rows
                        // 水位 03
                        if (response.rows.deviceType === '03') {
                            if (response.code === 200) {
                                time = response.rows.time
                                liquidLevelSign.push(data[1].typeDes)
                                signalSign.push('信号强度')
                                kwhSign.push('电池电量')
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "F":
                                            liquidLevel = item.value
                                            break;
                                        case "Q":
                                            signal = item.value
                                            break;
                                        case "V":
                                            kwh = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }
                            //echars
                            var myChartL = echarts.init(document.getElementById('chartShow-liquidLevel'),
                                null, {
                                renderer: 'svg'
                            });
                            var myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                null, {
                                renderer: 'svg'
                            });
                            var myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                                null, {
                                renderer: 'svg'
                            });
                            //液位
                            var optionL = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: liquidLevelSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: '液位',
                                    type: 'line',
                                    data: liquidLevel
                                }]
                            };
                            //电池电量
                            var optionV = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: kwhSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '电池电量',
                                    type: 'line',
                                    data: kwh
                                }]
                            };
                            //  信号强度
                            var optionQ = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: signalSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '信号强度',
                                    type: 'line',
                                    data: signal,
                                    markPoint: {
                                    data: [
                                        {type: 'max', name: '信号阈值'},
                                        ]
                                    }
                                }]
                            };
                            optionL && myChartL.setOption(optionL);
                            optionQ && myChartQ.setOption(optionQ);
                            optionV && myChartV.setOption(optionV);



                            // 判断节点是否显示
                            if ($('#chartShow-temperature').children().length === 0) {
                                $('#chartShow-temperature').css('display', 'none')
                            }
                            if ($('#chartShow-electric').children().length === 0) {
                                $('#chartShow-electric').css('display', 'none')
                            }
                            if ($('#chartShow-voltage').children().length === 0) {
                                $('#chartShow-voltage').css('display', 'none')
                            }
                            if ($('#chartShow-aftercurrent').children().length === 0) {
                                $('#chartShow-aftercurrent').css('display', 'none')
                            }
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        } else if (response.rows.deviceType === '01') {
                            if (response.code === 200) {
                                time = response.rows.time
                                voltageSign.push(data[1].typeDes, data[2].typeDes, data[3].typeDes)
                                electricSign.push(data[4].typeDes, data[5].typeDes, data[6].typeDes)
                                temperatureSign.push(data[7].typeDes, data[8].typeDes, data[9].typeDes, data[10]
                                    .typeDes)
                                electricRASign.push(data[0].typeDes)
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "residue_electricity":
                                            electricRA = item.value
                                            break;
                                        case "a_voltage":
                                            voltageA = item.value
                                            break;
                                        case "b_voltage":
                                            voltageB = item.value
                                            break;
                                        case "c_voltage":
                                            voltageC = item.value
                                            break;
                                        case "a_electricity":
                                            electricA = item.value
                                            break;
                                        case "b_electricity":
                                            electricB = item.value
                                            break;
                                        case "c_electricity":
                                            electricC = item.value
                                            break;
                                        case "a_temperature":
                                            temperatureA = item.value
                                            break;
                                        case "b_temperature":
                                            temperatureB = item.value
                                            break;
                                        case "c_temperature":
                                            temperatureC = item.value
                                            break;
                                        case "environment_temperature":
                                            temperatureE = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }
                            //echars
                            var myChartA = echarts.init(document.getElementById('chartShow-temperature'),
                                null, {
                                renderer: 'svg'
                            });
                            var myChartV = echarts.init(document.getElementById('chartShow-electric'), null, {
                                renderer: 'svg'
                            });
                            var myChartT = echarts.init(document.getElementById('chartShow-voltage'), null, {
                                renderer: 'svg'
                            });
                            var myChartRA = echarts.init(document.getElementById('chartShow-aftercurrent'),
                                null, {
                                renderer: 'svg'
                            });
                            //电流
                            var optionA = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: electricSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: 'A相电流',
                                    type: 'line',
                                    data: electricA
                                },
                                {
                                    name: 'B相电流',
                                    type: 'line',
                                    data: electricB
                                },
                                {
                                    name: 'C相电流',
                                    type: 'line',
                                    data: electricC
                                }
                                ]
                            };
                            //电压
                            var optionV = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: voltageSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: 'A相电压',
                                    type: 'line',
                                    data: voltageA
                                },
                                {
                                    name: 'B相电压',
                                    type: 'line',
                                    data: voltageB
                                },
                                {
                                    name: 'C相电压',
                                    type: 'line',
                                    data: voltageC
                                }
                                ]
                            };
                            //温度
                            var optionT = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: temperatureSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: 'A相温度',
                                    type: 'line',
                                    data: temperatureA
                                },
                                {
                                    name: 'B相温度',
                                    type: 'line',
                                    data: temperatureB
                                },
                                {
                                    name: 'C相温度',
                                    type: 'line',
                                    data: temperatureC
                                },
                                {
                                    name: '环境温度',
                                    type: 'line',
                                    data: temperatureE
                                }
                                ]
                            };
                            //剩余电流
                            var optionRA = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: electricRASign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    max: function (value) { return value.max }
                                },
                                series: [{
                                    name: '剩余电流',
                                    type: 'line',
                                    data: electricRA
                                }]
                            };
                            optionA && myChartA.setOption(optionA);
                            optionV && myChartV.setOption(optionV);
                            optionT && myChartT.setOption(optionT);
                            optionRA && myChartRA.setOption(optionRA);


                            // 判断节点是否显示
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                        } else if (response.rows.deviceType === '02') {
                            //水压 02
                            if (response.code === 200) {
                                time = response.rows.time
                                pressureSign.push(data[0].typeDes)
                                signalSign.push('信号强度')
                                kwhSign.push('电池电量')
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "F":
                                            pressure = item.value
                                            break;
                                        case "Q":
                                            signal = item.value
                                            break;
                                        case "V":
                                            kwh = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }

                           
                            //echars
                            var myChartP = echarts.init(document.getElementById('chartShow-pressure'),
                                null, {
                                renderer: 'svg'
                            });
                            let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                null, {
                                renderer: 'svg'
                            });
                            let myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                                null, {
                                renderer: 'svg'
                            });
                            //液位
                            var optionP = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: pressureSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: '压力',
                                    type: 'line',
                                    data: pressure
                                }]
                            };
                            //电池电量
                            var optionV = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: kwhSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '电池电量',
                                    type: 'line',
                                    data: kwh
                                }]
                            };
                             //信号强度
                            let optionQ = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: signalSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '信号强度',
                                    type: 'line',
                                    data: signal,
                                    markPoint: {
                                    data: [
                                        {type: 'max', name: '信号阈值'},
                                        ]
                                    }
                                }]
                            };
                            optionP && myChartP.setOption(optionP);
                            optionQ && myChartQ.setOption(optionQ);
                            optionV && myChartV.setOption(optionV);



                            // 判断节点是否显示
                            if ($('#chartShow-temperature').children().length === 0) {
                                $('#chartShow-temperature').css('display', 'none')
                            }
                            if ($('#chartShow-electric').children().length === 0) {
                                $('#chartShow-electric').css('display', 'none')
                            }
                            if ($('#chartShow-voltage').children().length === 0) {
                                $('#chartShow-voltage').css('display', 'none')
                            }
                            if ($('#chartShow-aftercurrent').children().length === 0) {
                                $('#chartShow-aftercurrent').css('display', 'none')
                            }
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        } else if (response.rows.deviceType === '06') {
                            //烟感 06
                            if (response.code === 200) {
                                time = response.rows.time
                                smokeDetectorSign.push('电压')
                                signalSign.push('信号强度')
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "V":
                                            smokeDetector = item.value
                                            break;
                                        case "Q":
                                            signal = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }

                            //echars
                            var myChartS = echarts.init(document.getElementById('chartShow-smokeDetector'),
                                null, {
                                renderer: 'svg'
                            });

                            let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                null, {
                                renderer: 'svg'
                            });

                            //电池电压
                            var optionS = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: smokeDetectorSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value'
                                },
                                series: [{
                                    name: '电压',
                                    type: 'line',
                                    data: smokeDetector
                                }]
                            };
                           
                            //信号强度
                            let optionQ = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: signalSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                },
                                series: [{
                                    name: '信号强度',
                                    type: 'line',
                                    data: signal,
                                    markPoint: {
                                    data: [
                                        {type: 'max', name: '信号阈值'},
                                        ]
                                    }
                                }]
                            };
                            optionS && myChartS.setOption(optionS);
                            optionQ && myChartQ.setOption(optionQ);



                            // 判断节点是否显示
                            if ($('#chartShow-temperature').children().length === 0) {
                                $('#chartShow-temperature').css('display', 'none')
                            }
                            if ($('#chartShow-electric').children().length === 0) {
                                $('#chartShow-electric').css('display', 'none')
                            }
                            if ($('#chartShow-voltage').children().length === 0) {
                                $('#chartShow-voltage').css('display', 'none')
                            }
                            if ($('#chartShow-aftercurrent').children().length === 0) {
                                $('#chartShow-aftercurrent').css('display', 'none')
                            }
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        }else if (response.rows.deviceType === '07') {
                            //可燃气体 07
                            if (response.code === 200) {
                                time = response.rows.time
                                combustibleSign.push(data[1].typeDes)
                                signalSign.push('信号强度')
                                data.map(item => {
                                    switch (item.dataType) {
                                        case "V":
                                            combustible = item.value
                                            break;
                                        default:
                                            break;
                                    }
                                })
                            }

                            //echars
                            var myChartS = echarts.init(document.getElementById('chartShow-combustible'),
                                null, {
                                renderer: 'svg'
                            });

                            //电池电压
                            var optionS = {
                                tooltip: {
                                    trigger: 'axis'
                                },
                                legend: {
                                    data: combustibleSign
                                },
                                grid: {
                                    left: '3%',
                                    right: '4%',
                                    bottom: '3%',
                                    containLabel: true
                                },
                                toolbox: {
                                    feature: {
                                        saveAsImage: {}
                                    }
                                },
                                xAxis: {
                                    type: 'category',
                                    boundaryGap: false,
                                    data: time
                                },
                                yAxis: {
                                    type: 'value',
                                    //max: function (value) { return value.max },
                                    max: function (value) { return '3.5' },
                                    show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                    axisTick:{
                                        show:true//不显示坐标轴刻度线
                                    },
                                    axisLine: {
                                        show: true,//不显示坐标轴线
                                    },
                                    axisLabel: {
                                        show: true,//不显示坐标轴上的文字
                                    }
                                    
                                },
                                series: [{
                                    name: '电压',
                                    type: 'line',
                                    data: combustible,
                                    markPoint: {
                                    data: [
                                        {type: 'min', name: '最低电压'},
                                        ]
                                    },
                                    markLine: {
                                    symbol:"none", //表示没有箭头的直线
                                    lineStyle:{
                                    type:"dashed",
                                    color:"red",
                                },
                                    data: [
                                    {yAxis:'2.8',label: {position:'middle',formatter: '电池低压阈值:2.8V'}}
                                    ]
                                    }
                                }]
                            };
                            optionS && myChartS.setOption(optionS);

                            const infoMapData = data.map(item => {
                                var value = item.value.pop()
                                return `
                                <p>
                                    <span class="data-record-content-icon"></span>
                                    <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                                </p>
                            `
                            })

                            var time = time.pop()
                            const $infoData = `
                            <div class="data-record-content-time">
                                最后上报时间 : ${time === undefined ? '-' : time}
                            </div>
                            ${infoMapData.join('')}
                            `
                            $(".data-record-content").html($infoData)

                            // 判断节点是否显示
                            if ($('#chartShow-temperature').children().length === 0) {
                                $('#chartShow-temperature').css('display', 'none')
                            }
                            if ($('#chartShow-electric').children().length === 0) {
                                $('#chartShow-electric').css('display', 'none')
                            }
                            if ($('#chartShow-voltage').children().length === 0) {
                                $('#chartShow-voltage').css('display', 'none')
                            }
                            if ($('#chartShow-aftercurrent').children().length === 0) {
                                $('#chartShow-aftercurrent').css('display', 'none')
                            }
                            if ($('#chartShow-liquidLevel').children().length === 0) {
                                $('#chartShow-liquidLevel').css('display', 'none')
                            }
                            if ($('#chartShow-pressure').children().length === 0) {
                                $('#chartShow-pressure').css('display', 'none')
                            }
                            if ($('#chartShow-smokeDetector').children().length === 0) {
                                $('#chartShow-smokeDetector').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-combustible').children().length === 0) {
                                $('#chartShow-combustible').css('display', 'none')
                            }
                            if ($('#chartShow-signal').children().length === 0) {
                                $('#chartShow-signal').css('display', 'none')
                            }
                            if ($('#chartShow-kwh').children().length === 0) {
                                $('#chartShow-kwh').css('display', 'none')
                            }
                        }
                        } else if(res.code === 20001){
                            layer.alert('登录已过期请重新登陆', {
                                skin: 'layui-layer-yingke' //样式类名
                                ,closeBtn: 0
                                }, function(){
                                    parent.location.href = './index.html'
                                });
                        } else {
                            layer.msg(res.msg, {
                                icon: 2,
                                closeBtn: 0,
                                anim: 6, //动画类型
                                time: 3000
                            });
                        }
                    },
                    error: function () {

                    }
                })

            } else if (index === 'month') {
                //最近一个月
                $.ajax({
                    url: baseUrl + "/deviceworkdata/list?&pageSize=10&pageNumber=1&token=" + JSON.parse(localStorage.getItem('loginInfo'))
                        .token + "&happen_time=" + s3,
                    type: 'get',
                    data: getUrl(window.location.href),
                    success: function (res) {
                       if(res.code === 200){
                            const { fieldlist, dataList } = res.rows
                            //历史信息表格
                            var tableTitle = fieldlist.map(item => {
                                return { field: item.dataType, title: item.typeDes }
                            })
                            tableTitle.unshift({ field: 'happen_time', title: '上报时间' })

                            
                            //渲染历史数据表格
                            layui.use('table', function () {
                                var table = layui.table;

                                table.reload('tableReload', {
                                    page: {
                                        curr: 1 //重新从第 1 页开始
                                    }
                                });
                            });
                       }else if(res.code === 20001){
                            layer.alert('登录已过期请重新登陆', {
                                skin: 'layui-layer-yingke' //样式类名
                                ,closeBtn: 0
                                }, function(){
                                    parent.location.href = './index.html'
                                });
                        } else {
                            layer.msg(res.msg, {
                                icon: 1,
                                closeBtn: 0,
                                anim: 6, //动画类型
                                time: 3000
                            });
                        }
                    }
                })
                $.ajax({
                    url: baseUrl + "/deviceworkdata/zxlist?token=" + JSON.parse(localStorage.getItem('loginInfo'))
                        .token + "&happen_time=" + s3,
                    type: 'get',
                    data: getUrl(window.location.href),
                    success: function (response) {
                        if(response.code === 200){
                            
                            const {
                                data, deviceInfo, deviceData
                            } = response.rows

                            // 水位 03
                            if (response.rows.deviceType === '03') {
                                if (response.code === 200) {
                                    time = response.rows.time
                                    liquidLevelSign.push(data[1].typeDes)
                                    signalSign.push('信号强度')
                                    kwhSign.push('电池电量')
                                    data.map(item => {
                                        switch (item.dataType) {
                                            case "F":
                                                liquidLevel = item.value
                                                break;
                                            case "Q":
                                                signal = item.value
                                                break;
                                            case "V":
                                                kwh = item.value
                                                break;
                                            default:
                                                break;
                                        }
                                    })
                                }
                                //echars
                                var myChartL = echarts.init(document.getElementById('chartShow-liquidLevel'),
                                    null, {
                                    renderer: 'svg'
                                });
                                var myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                    null, {
                                    renderer: 'svg'
                                });
                                var myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                                    null, {
                                    renderer: 'svg'
                                });


                                //液位
                                var optionL = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: liquidLevelSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value'
                                    },
                                    series: [{
                                        name: '液位',
                                        type: 'line',
                                        data: liquidLevel
                                    }]
                                };
                                //电池电量
                                var optionV = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: kwhSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value',
                                        show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                        axisTick:{
                                            show:true//不显示坐标轴刻度线
                                        },
                                        axisLine: {
                                            show: true,//不显示坐标轴线
                                        },
                                        axisLabel: {
                                            show: true,//不显示坐标轴上的文字
                                        }
                                    },
                                    series: [{
                                        name: '电池电量',
                                        type: 'line',
                                        data: kwh
                                    }]
                                };
                                //  信号强度
                                var optionQ = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: signalSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value',
                                        show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                        axisTick:{
                                            show:true//不显示坐标轴刻度线
                                        },
                                        axisLine: {
                                            show: true,//不显示坐标轴线
                                        },
                                        axisLabel: {
                                            show: true,//不显示坐标轴上的文字
                                        }
                                    },
                                    series: [{
                                        name: '信号强度',
                                        type: 'line',
                                        data: signal,
                                        markPoint: {
                                        data: [
                                            {type: 'max', name: '信号阈值'},
                                            ]
                                        }
                                    }]
                                };
                                optionL && myChartL.setOption(optionL);
                                optionQ && myChartQ.setOption(optionQ);
                                optionV && myChartV.setOption(optionV);



                                // 判断节点是否显示
                                if ($('#chartShow-temperature').children().length === 0) {
                                    $('#chartShow-temperature').css('display', 'none')
                                }
                                if ($('#chartShow-electric').children().length === 0) {
                                    $('#chartShow-electric').css('display', 'none')
                                }
                                if ($('#chartShow-voltage').children().length === 0) {
                                    $('#chartShow-voltage').css('display', 'none')
                                }
                                if ($('#chartShow-aftercurrent').children().length === 0) {
                                    $('#chartShow-aftercurrent').css('display', 'none')
                                }
                                if ($('#chartShow-liquidLevel').children().length === 0) {
                                    $('#chartShow-liquidLevel').css('display', 'none')
                                }
                                if ($('#chartShow-pressure').children().length === 0) {
                                    $('#chartShow-pressure').css('display', 'none')
                                }
                                if ($('#chartShow-smokeDetector').children().length === 0) {
                                    $('#chartShow-smokeDetector').css('display', 'none')
                                }
                                if ($('#chartShow-combustible').children().length === 0) {
                                    $('#chartShow-combustible').css('display', 'none')
                                }
                                if ($('#chartShow-signal').children().length === 0) {
                                    $('#chartShow-signal').css('display', 'none')
                                }
                                if ($('#chartShow-kwh').children().length === 0) {
                                    $('#chartShow-kwh').css('display', 'none')
                                }
                            } else if (response.rows.deviceType === '01') {
                                if (response.code === 200) {
                                    time = response.rows.time
                                    voltageSign.push(data[1].typeDes, data[2].typeDes, data[3].typeDes)
                                    electricSign.push(data[4].typeDes, data[5].typeDes, data[6].typeDes)
                                    temperatureSign.push(data[7].typeDes, data[8].typeDes, data[9].typeDes, data[10]
                                        .typeDes)
                                    electricRASign.push(data[0].typeDes)
                                    data.map(item => {
                                        switch (item.dataType) {
                                            case "residue_electricity":
                                                electricRA = item.value
                                                break;
                                            case "a_voltage":
                                                voltageA = item.value
                                                break;
                                            case "b_voltage":
                                                voltageB = item.value
                                                break;
                                            case "c_voltage":
                                                voltageC = item.value
                                                break;
                                            case "a_electricity":
                                                electricA = item.value
                                                break;
                                            case "b_electricity":
                                                electricB = item.value
                                                break;
                                            case "c_electricity":
                                                electricC = item.value
                                                break;
                                            case "a_temperature":
                                                temperatureA = item.value
                                                break;
                                            case "b_temperature":
                                                temperatureB = item.value
                                                break;
                                            case "c_temperature":
                                                temperatureC = item.value
                                                break;
                                            case "environment_temperature":
                                                temperatureE = item.value
                                                break;
                                            default:
                                                break;
                                        }
                                    })
                                }
                                //echars
                                var myChartA = echarts.init(document.getElementById('chartShow-temperature'),
                                    null, {
                                    renderer: 'svg'
                                });
                                var myChartV = echarts.init(document.getElementById('chartShow-electric'), null, {
                                    renderer: 'svg'
                                });
                                var myChartT = echarts.init(document.getElementById('chartShow-voltage'), null, {
                                    renderer: 'svg'
                                });
                                var myChartRA = echarts.init(document.getElementById('chartShow-aftercurrent'),
                                    null, {
                                    renderer: 'svg'
                                });
                                //电流
                                var optionA = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: electricSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value'
                                    },
                                    series: [{
                                        name: 'A相电流',
                                        type: 'line',
                                        data: electricA
                                    },
                                    {
                                        name: 'B相电流',
                                        type: 'line',
                                        data: electricB
                                    },
                                    {
                                        name: 'C相电流',
                                        type: 'line',
                                        data: electricC
                                    }
                                    ]
                                };
                                //电压
                                var optionV = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: voltageSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value'
                                    },
                                    series: [{
                                        name: 'A相电压',
                                        type: 'line',
                                        data: voltageA
                                    },
                                    {
                                        name: 'B相电压',
                                        type: 'line',
                                        data: voltageB
                                    },
                                    {
                                        name: 'C相电压',
                                        type: 'line',
                                        data: voltageC
                                    }
                                    ]
                                };
                                //温度
                                var optionT = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: temperatureSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value'
                                    },
                                    series: [{
                                        name: 'A相温度',
                                        type: 'line',
                                        data: temperatureA
                                    },
                                    {
                                        name: 'B相温度',
                                        type: 'line',
                                        data: temperatureB
                                    },
                                    {
                                        name: 'C相温度',
                                        type: 'line',
                                        data: temperatureC
                                    },
                                    {
                                        name: '环境温度',
                                        type: 'line',
                                        data: temperatureE
                                    }
                                    ]
                                };
                                //剩余电流
                                var optionRA = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: electricRASign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value',
                                        max: function (value) { return value.max }
                                    },
                                    series: [{
                                        name: '剩余电流',
                                        type: 'line',
                                        data: electricRA
                                    }]
                                };
                                optionA && myChartA.setOption(optionA);
                                optionV && myChartV.setOption(optionV);
                                optionT && myChartT.setOption(optionT);
                                optionRA && myChartRA.setOption(optionRA);


                                // 判断节点是否显示
                                if ($('#chartShow-liquidLevel').children().length === 0) {
                                    $('#chartShow-liquidLevel').css('display', 'none')
                                }
                                if ($('#chartShow-pressure').children().length === 0) {
                                    $('#chartShow-pressure').css('display', 'none')
                                }
                                if ($('#chartShow-smokeDetector').children().length === 0) {
                                    $('#chartShow-smokeDetector').css('display', 'none')
                                }
                                if ($('#chartShow-combustible').children().length === 0) {
                                    $('#chartShow-combustible').css('display', 'none')
                                }
                                if ($('#chartShow-signal').children().length === 0) {
                                    $('#chartShow-signal').css('display', 'none')
                                }
                            } else if (response.rows.deviceType === '02') {
                                //水压 02
                                if (response.code === 200) {
                                    time = response.rows.time
                                    pressureSign.push(data[0].typeDes)
                                    signalSign.push('信号强度')
                                    kwhSign.push('电池电量')
                                    data.map(item => {
                                        switch (item.dataType) {
                                            case "F":
                                                pressure = item.value
                                                break;
                                            case "Q":
                                                signal = item.value
                                                break;
                                            case "V":
                                                KWH = item.value
                                                break;
                                            default:
                                                break;
                                        }
                                    })
                                }

                                
                                //echars
                                var myChartP = echarts.init(document.getElementById('chartShow-pressure'),
                                    null, {
                                    renderer: 'svg'
                                });

                                let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                    null, {
                                    renderer: 'svg'
                                });
                                let myChartV = echarts.init(document.getElementById('chartShow-kwh'),
                                    null, {
                                    renderer: 'svg'
                                });

                                //液位
                                var optionP = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: pressureSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value'
                                    },
                                    series: [{
                                        name: '压力',
                                        type: 'line',
                                        data: pressure,
                                        
                                    }]
                                };
                                //电池电量
                                var optionV = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: kwhSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value',
                                        show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                        axisTick:{
                                            show:true//不显示坐标轴刻度线
                                        },
                                        axisLine: {
                                            show: true,//不显示坐标轴线
                                        },
                                        axisLabel: {
                                            show: true,//不显示坐标轴上的文字
                                        }
                                    },
                                    series: [{
                                        name: '电池电量',
                                        type: 'line',
                                        data: kwh
                                    }]
                                };
                               //信号强度
                                let optionQ = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: signalSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value',
                                        show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                        axisTick:{
                                            show:true//不显示坐标轴刻度线
                                        },
                                        axisLine: {
                                            show: true,//不显示坐标轴线
                                        },
                                        axisLabel: {
                                            show: true,//不显示坐标轴上的文字
                                        }
                                    },
                                    series: [{
                                        name: '信号强度',
                                        type: 'line',
                                        data: signal,
                                        markPoint: {
                                        data: [
                                            {type: 'max', name: '信号阈值'},
                                            ]
                                        }
                                    }]
                                };
                                optionP && myChartP.setOption(optionP);
                                optionQ && myChartQ.setOption(optionQ);
                                optionV && myChartV.setOption(optionV);



                                // 判断节点是否显示
                                if ($('#chartShow-temperature').children().length === 0) {
                                    $('#chartShow-temperature').css('display', 'none')
                                }
                                if ($('#chartShow-electric').children().length === 0) {
                                    $('#chartShow-electric').css('display', 'none')
                                }
                                if ($('#chartShow-voltage').children().length === 0) {
                                    $('#chartShow-voltage').css('display', 'none')
                                }
                                if ($('#chartShow-aftercurrent').children().length === 0) {
                                    $('#chartShow-aftercurrent').css('display', 'none')
                                }
                                if ($('#chartShow-liquidLevel').children().length === 0) {
                                    $('#chartShow-liquidLevel').css('display', 'none')
                                }
                                if ($('#chartShow-pressure').children().length === 0) {
                                    $('#chartShow-pressure').css('display', 'none')
                                }
                                if ($('#chartShow-smokeDetector').children().length === 0) {
                                    $('#chartShow-smokeDetector').css('display', 'none')
                                }
                                if ($('#chartShow-combustible').children().length === 0) {
                                    $('#chartShow-combustible').css('display', 'none')
                                }
                                if ($('#chartShow-signal').children().length === 0) {
                                    $('#chartShow-signal').css('display', 'none')
                                }
                                if ($('#chartShow-kwh').children().length === 0) {
                                    $('#chartShow-kwh').css('display', 'none')
                                }
                            } else if (response.rows.deviceType === '06') {
                                //烟感 06
                                if (response.code === 200) {
                                    time = response.rows.time
                                    smokeDetectorSign.push('电压')
                                    signalSign.push('信号强度')
                                    data.map(item => {
                                        switch (item.dataType) {
                                            case "V":
                                                smokeDetector = item.value
                                                break;
                                            case "Q":
                                                signal = item.value
                                                break;
                                            default:
                                                break;
                                        }
                                    })
                                }

                                //echars
                                var myChartS = echarts.init(document.getElementById('chartShow-smokeDetector'),
                                    null, {
                                    renderer: 'svg'
                                });

                                let myChartQ = echarts.init(document.getElementById('chartShow-signal'),
                                    null, {
                                    renderer: 'svg'
                                });

                                //电池电压
                                var optionS = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: smokeDetectorSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value'
                                    },
                                    series: [{
                                        name: '电压',
                                        type: 'line',
                                        data: smokeDetector
                                    }]
                                };
                                //信号强度
                                let optionQ = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: signalSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value',
                                        show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                        axisTick:{
                                            show:true//不显示坐标轴刻度线
                                        },
                                        axisLine: {
                                            show: true,//不显示坐标轴线
                                        },
                                        axisLabel: {
                                            show: true,//不显示坐标轴上的文字
                                        }
                                    },
                                    series: [{
                                        name: '信号强度',
                                        type: 'line',
                                        data: signal,
                                        markPoint: {
                                        data: [
                                            {type: 'max', name: '信号阈值'},
                                            ]
                                        }
                                    }]
                                };
                                optionS && myChartS.setOption(optionS);
                                optionQ && myChartQ.setOption(optionQ);



                                // 判断节点是否显示
                                if ($('#chartShow-temperature').children().length === 0) {
                                    $('#chartShow-temperature').css('display', 'none')
                                }
                                if ($('#chartShow-electric').children().length === 0) {
                                    $('#chartShow-electric').css('display', 'none')
                                }
                                if ($('#chartShow-voltage').children().length === 0) {
                                    $('#chartShow-voltage').css('display', 'none')
                                }
                                if ($('#chartShow-aftercurrent').children().length === 0) {
                                    $('#chartShow-aftercurrent').css('display', 'none')
                                }
                                if ($('#chartShow-liquidLevel').children().length === 0) {
                                    $('#chartShow-liquidLevel').css('display', 'none')
                                }
                                if ($('#chartShow-pressure').children().length === 0) {
                                    $('#chartShow-pressure').css('display', 'none')
                                }
                                if ($('#chartShow-smokeDetector').children().length === 0) {
                                    $('#chartShow-smokeDetector').css('display', 'none')
                                }
                                if ($('#chartShow-combustible').children().length === 0) {
                                    $('#chartShow-combustible').css('display', 'none')
                                }
                                if ($('#chartShow-signal').children().length === 0) {
                                    $('#chartShow-signal').css('display', 'none')
                                }
                                if ($('#chartShow-kwh').children().length === 0) {
                                    $('#chartShow-kwh').css('display', 'none')
                                }
                            }else if (response.rows.deviceType === '07') {
                                //可燃气体 07
                                if (response.code === 200) {
                                    time = response.rows.time
                                    combustibleSign.push(data[1].typeDes)
                                    data.map(item => {
                                        switch (item.dataType) {
                                            case "V":
                                                combustible = item.value
                                                break;
                                            default:
                                                break;
                                        }
                                    })
                                }

                                //echars
                                var myChartS = echarts.init(document.getElementById('chartShow-combustible'),
                                    null, {
                                    renderer: 'svg'
                                });

                                //电池电压
                                var optionS = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    legend: {
                                        data: combustibleSign
                                    },
                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            saveAsImage: {}
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        data: time
                                    },
                                    yAxis: {
                                        type: 'value',
                                        //max: function (value) { return value.max },
                                        max: function (value) { return '3.5' },
                                        show:true,//不显示坐标轴线、坐标轴刻度线和坐标轴上的文字
                                        axisTick:{
                                            show:true//不显示坐标轴刻度线
                                        },
                                        axisLine: {
                                            show: true,//不显示坐标轴线
                                        },
                                        axisLabel: {
                                            show: true,//不显示坐标轴上的文字
                                        }
                                        
                                    },
                                    series: [{
                                        name: '电压',
                                        type: 'line',
                                        data: combustible,
                                        markPoint: {
                                        data: [
                                            {type: 'min', name: '最低电压'},
                                            ]
                                        },
                                        markLine: {
                                        symbol:"none", //表示没有箭头的直线
                                        lineStyle:{
                                        type:"dashed",
                                        color:"red",
                                    },
                                        data: [
                                        {yAxis:'2.8',label: {position:'middle',formatter: '电池低压阈值:2.8V'}}
                                        ]
                                        }
                                    }]
                                };
                                optionS && myChartS.setOption(optionS);

                                const infoMapData = data.map(item => {
                                    var value = item.value.pop()
                                    return `
                                    <p>
                                        <span class="data-record-content-icon"></span>
                                        <span class="data-record-content-detail">${item.typeDes}：${value === undefined ? '-' : value} ${item.typeUnit}</span>
                                    </p>
                                `
                                })

                                var time = time.pop()
                                const $infoData = `
                                <div class="data-record-content-time">
                                    最后上报时间 : ${time === undefined ? '-' : time}
                                </div>
                                ${infoMapData.join('')}
                                `
                                $(".data-record-content").html($infoData)

                                // 判断节点是否显示
                                if ($('#chartShow-temperature').children().length === 0) {
                                    $('#chartShow-temperature').css('display', 'none')
                                }
                                if ($('#chartShow-electric').children().length === 0) {
                                    $('#chartShow-electric').css('display', 'none')
                                }
                                if ($('#chartShow-voltage').children().length === 0) {
                                    $('#chartShow-voltage').css('display', 'none')
                                }
                                if ($('#chartShow-aftercurrent').children().length === 0) {
                                    $('#chartShow-aftercurrent').css('display', 'none')
                                }
                                if ($('#chartShow-liquidLevel').children().length === 0) {
                                    $('#chartShow-liquidLevel').css('display', 'none')
                                }
                                if ($('#chartShow-pressure').children().length === 0) {
                                    $('#chartShow-pressure').css('display', 'none')
                                }
                                if ($('#chartShow-smokeDetector').children().length === 0) {
                                    $('#chartShow-smokeDetector').css('display', 'none')
                                }
                                if ($('#chartShow-combustible').children().length === 0) {
                                    $('#chartShow-combustible').css('display', 'none')
                                }
                                if ($('#chartShow-signal').children().length === 0) {
                                    $('#chartShow-signal').css('display', 'none')
                                }
                                if ($('#chartShow-kwh').children().length === 0) {
                                    $('#chartShow-kwh').css('display', 'none')
                                }
                            }
                        }else if(res.code === 20001){
                            layer.alert('登录已过期请重新登陆', {
                                skin: 'layui-layer-yingke' //样式类名
                                ,closeBtn: 0
                                }, function(){
                                    parent.location.href = './index.html'
                                });
                        } else {
                            layer.msg(res.msg, {
                                icon: 2,
                                closeBtn: 0,
                                anim: 6, //动画类型
                                time: 3000
                            });
                        }
                    },
                    error: function () {

                    }
                })
                //报警信息
                layui.use('table', function () {
                    var table = layui.table;
                    table.reload('alarmTableReload', {
                        page: {
                            curr: 1 //重新从第 1 页开始
                        },
                        where:{
                            alarmDate: s3,
                            ykDeviceId: getUrl(window.location.href).id
                        }
                    });
                });

            } else if (index === 'realtime') {
                $(".chartShow").css('display', 'block')
                $(".historyData").css('display', 'none')
                $(".alarmInfo").css('display', 'none')
            } else if (index === 'history') {
                $(".chartShow").css('display', 'none')
                $(".historyData").css('display', 'block')
                $(".alarmInfo").css('display', 'none')
            } else if (index === 'alarm') {
                $(".chartShow").css('display', 'none')
                $(".historyData").css('display', 'none')
                $(".alarmInfo").css('display', 'block')
            }
        })



    })
</script>

</html>